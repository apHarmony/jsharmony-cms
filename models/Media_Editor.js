/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is not neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/bottomToolbar.js":
/*!******************************!*\
  !*** ./src/bottomToolbar.js ***!
  \******************************/
/*! namespace exports */
/*! export BottomToolbar [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"BottomToolbar\": () => /* binding */ BottomToolbar\n/* harmony export */ });\n/**\r\n * @class\r\n */\r\nfunction BottomToolbar($imageEditor) {\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$toolbar = $imageEditor.find('.bottomToolbar');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$resetButton = this._$toolbar.find('[data-action=\"reset\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$zoomInButton = this._$toolbar.find('[data-action=\"zoomIn\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$zoomOutButton = this._$toolbar.find('[data-action=\"zoomOut\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cancelButton = this._$toolbar.find('[data-action=\"close\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$doneButton = this._$toolbar.find('[data-action=\"done\"]');\r\n\r\n  /**\r\n   * @public\r\n   * @type {(() => void) | undefined}\r\n   */\r\n  this.onCancel = undefined;\r\n\r\n  /**\r\n   * @public\r\n   * @type {(() => void) | undefined}\r\n   */\r\n  this.onDone = undefined;\r\n\r\n  /**\r\n   * @public\r\n   * @type {(() => void) | undefined}\r\n   */\r\n  this.onReset = undefined;\r\n\r\n  /**\r\n   * @public\r\n   * @type {((zoomIn: boolean) => void) | undefined}\r\n   */\r\n  this.onSetZoom = undefined;\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nBottomToolbar.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n\r\n  this._$cancelButton.off('click.media_editor').on('click.media_editor', function() {\r\n    if (self.onCancel) self.onCancel();\r\n  });\r\n\r\n  this._$doneButton.off('click.media_editor').on('click.media_editor', function() {\r\n    if (self.onDone) self.onDone();\r\n  });\r\n\r\n  this._$resetButton.off('click.media_editor').on('click.media_editor', function() {\r\n    if (self.onReset) self.onReset();\r\n  });\r\n\r\n  this._$zoomInButton.off('click.media_editor'). on('click.media_editor', function() {\r\n    if (self.onSetZoom) self.onSetZoom(true);\r\n  });\r\n\r\n  this._$zoomOutButton.off('click.media_editor'). on('click.media_editor', function() {\r\n    if (self.onSetZoom) self.onSetZoom(false);\r\n  });\r\n}\n\n//# sourceURL=webpack:///./src/bottomToolbar.js?");

/***/ }),

/***/ "./src/brightnessEditor.js":
/*!*********************************!*\
  !*** ./src/brightnessEditor.js ***!
  \*********************************/
/*! namespace exports */
/*! export BrightnessEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"BrightnessEditor\": () => /* binding */ BrightnessEditor\n/* harmony export */ });\n/**\r\n * @class\r\n * @param {JQuery} $imageEditor\r\n */\r\nfunction BrightnessEditor($imageEditor) {\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$editor = $imageEditor.find('[data-editor=\"brightness\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$brightnessSlider = this._$editor.find('[data-control-id=\"brightnessRange\"]');\r\n\r\n  /** @private @type {number} */\r\n  this._brightness = 0;\r\n\r\n  /**\r\n   * Called when the model changes\r\n   * @public\r\n   * @type {(brightness: number) => void)}\r\n   */\r\n  this.onBrightnessChange = undefined;\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nBrightnessEditor.prototype.activate = function() {\r\n  this._$editor.show();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nBrightnessEditor.prototype.deactivate = function() {\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {string}\r\n */\r\nBrightnessEditor.prototype.getTitle = function() {\r\n  return this._$editor.attr('data-editor-title')\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nBrightnessEditor.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n  this._$brightnessSlider.off('change.media_editor').on('change.media_editor', function() {\r\n    self._brightness = parseFloat(self._$brightnessSlider[0].value);\r\n    if (self.onBrightnessChange) self.onBrightnessChange(self._brightness);\r\n  });\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {number} brightness\r\n * @returns {void}\r\n */\r\nBrightnessEditor.prototype.setBrightness = function(brightness) {\r\n  this._brightness = brightness;\r\n  this._$brightnessSlider[0].value = brightness\r\n}\n\n//# sourceURL=webpack:///./src/brightnessEditor.js?");

/***/ }),

/***/ "./src/colorEditor.js":
/*!****************************!*\
  !*** ./src/colorEditor.js ***!
  \****************************/
/*! namespace exports */
/*! export ColorEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"ColorEditor\": () => /* binding */ ColorEditor\n/* harmony export */ });\n/** @typedef {import('./imageEditorController').ColorModel} ColorModel */\r\n\r\n/**\r\n * @class\r\n * @param {JQuery} $imageEditor\r\n */\r\nfunction ColorEditor($imageEditor) {\r\n  this._$editor = $imageEditor.find('[data-editor=\"color\"]');\r\n\r\n  /** @private @type {(ColorModel | undefined)} */\r\n  this._model = {\r\n    blueLevel: 0,\r\n    greenLevel: 0,\r\n    redLevel: 0\r\n  };\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$redSlider = this._$editor.find('[data-control-id=\"redRange\"]');\r\n  /** @private @type {JQuery} */\r\n  this._$greenSlider = this._$editor.find('[data-control-id=\"greenRange\"]');\r\n  /** @private @type {JQuery} */\r\n  this._$blueSlider = this._$editor.find('[data-control-id=\"blueRange\"]');\r\n\r\n  /**\r\n   * @public\r\n   * @type {(red: number, green: number, blue: number) => void}\r\n   */\r\n  this.onLevelsChanged = undefined;\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nColorEditor.prototype.activate = function() {\r\n  this._$editor.show();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nColorEditor.prototype.deactivate = function() {\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {string}\r\n */\r\nColorEditor.prototype.getTitle = function() {\r\n  return this._$editor.attr('data-editor-title')\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nColorEditor.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n\r\n  this._$blueSlider.off('change.media_editor').on('change.media_editor', function() { self.onChangeColorLevel('blue'); });\r\n  this._$greenSlider.off('change.media_editor').on('change.media_editor', function() { self.onChangeColorLevel('green'); });\r\n  this._$redSlider.off('change.media_editor').on('change.media_editor', function() { self.onChangeColorLevel('red'); });\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {('red' | 'green' | 'blue')} color\r\n * @returns {void}\r\n */\r\nColorEditor.prototype.onChangeColorLevel = function(color) {\r\n\r\n  if (color === 'blue') {\r\n    this._model.blueLevel = parseFloat(this._$blueSlider[0].value);\r\n  } else if (color === 'green') {\r\n    this._model.greenLevel = parseFloat(this._$greenSlider[0].value);\r\n  } else if (color === 'red') {\r\n    this._model.redLevel = parseFloat(this._$redSlider[0].value);\r\n  } else {\r\n    throw new Error('Don\\'t know how to handle color \"' + color + '\"');\r\n  }\r\n\r\n  if (this.onLevelsChanged) this.onLevelsChanged(this._model.redLevel, this._model.greenLevel, this._model.blueLevel);\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {number} red\r\n * @param {number} green\r\n * @param {number} blue\r\n * @returns {void}\r\n */\r\nColorEditor.prototype.setLevels = function(red, green, blue) {\r\n  this._$blueSlider[0].value = blue;\r\n  this._$greenSlider[0].value = green;\r\n  this._$redSlider[0].value = red;\r\n\r\n  this._model = {\r\n    blueLevel: blue,\r\n    greenLevel: green,\r\n    redLevel: red\r\n  };\r\n}\n\n//# sourceURL=webpack:///./src/colorEditor.js?");

/***/ }),

/***/ "./src/contrastEditor.js":
/*!*******************************!*\
  !*** ./src/contrastEditor.js ***!
  \*******************************/
/*! namespace exports */
/*! export ContrastEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"ContrastEditor\": () => /* binding */ ContrastEditor\n/* harmony export */ });\n/**\r\n * @class\r\n * @param {JQuery} $imageEditor\r\n */\r\nfunction ContrastEditor($imageEditor) {\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$editor = $imageEditor.find('[data-editor=\"contrast\"]');\r\n\r\n  /** @private @type {number} */\r\n  this._contrast = 0;\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$contrastSlider = this._$editor.find('[data-control-id=\"contrastRange\"]');\r\n\r\n  /**\r\n   * @public\r\n   * @type {(contrast: number) => void}\r\n   */\r\n  this.onContrastChange = undefined;\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nContrastEditor.prototype.activate = function() {\r\n  this._$editor.show();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nContrastEditor.prototype.deactivate = function() {\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {string}\r\n */\r\nContrastEditor.prototype.getTitle = function() {\r\n  return this._$editor.attr('data-editor-title');\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nContrastEditor.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n\r\n  this._$contrastSlider.off('change.media_editor').on('change.media_editor', function() {  \r\n    self._contrast = parseFloat(self._$contrastSlider[0].value);\r\n    if (self.onContrastChange) self.onContrastChange(self._contrast);\r\n  });\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {number} contrast\r\n * @returns {void}\r\n */\r\nContrastEditor.prototype.setContrast = function(contrast) {\r\n  this._$contrastSlider[0].value = contrast;\r\n}\n\n//# sourceURL=webpack:///./src/contrastEditor.js?");

/***/ }),

/***/ "./src/cropEditor.js":
/*!***************************!*\
  !*** ./src/cropEditor.js ***!
  \***************************/
/*! namespace exports */
/*! export CropEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__, __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"CropEditor\": () => /* binding */ CropEditor\n/* harmony export */ });\n/* harmony import */ var _image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./image */ \"./src/image.js\");\n\r\n\r\n/** @typedef {import('./imageEditorController').RelativeCropWindow} RelativeCropWindow */\r\n\r\n\r\n\r\n/**\r\n * @class\r\n * @param {JQuery} $imageWrapper\r\n * @param {JQuery} $imageEditor\r\n * @param {Image} image\r\n */\r\nfunction CropEditor($imageEditor, $imageWrapper, image) {\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$editor = $imageEditor.find('[data-editor=\"crop\"]');\r\n\r\n  /** @private @type {Image} */\r\n  this._image = image;\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropWidthNum = this._$editor.find('[data-control-id=\"cropWidth\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropHeightNum = this._$editor.find('[data-control-id=\"cropHeight\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropWindowContainer = $imageWrapper.find('.cropWindowContainer');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropShadowTop = $imageWrapper.find('.cropWindowContainer [data-crop-shadow=\"top\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropShadowBottom = $imageWrapper.find('.cropWindowContainer [data-crop-shadow=\"bottom\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropShadowLeft = $imageWrapper.find('.cropWindowContainer [data-crop-shadow=\"left\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropShadowRight = $imageWrapper.find('.cropWindowContainer [data-crop-shadow=\"right\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropWindow = $imageWrapper.find('.cropWindowContainer .cropWindow');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropWindowHandleTopLeft = $imageWrapper.find('.cropWindowContainer [data-crop-handle=\"topLeft\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropWindowHandleTopRight = $imageWrapper.find('.cropWindowContainer [data-crop-handle=\"topRight\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropWindowHandleBottomLeft = $imageWrapper.find('.cropWindowContainer [data-crop-handle=\"bottomLeft\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropWindowHandleBottomRight = $imageWrapper.find('.cropWindowContainer [data-crop-handle=\"bottomRight\"]');\r\n\r\n  /** @private @type {RelativeCropWindow} */\r\n  this._window = {\r\n    x0: 0,\r\n    x1: 1,\r\n    y0: 0,\r\n    y1: 1\r\n  }\r\n\r\n  /** \r\n   * @public\r\n   * @type {(window: RelativeCropWindow) => void}\r\n   **/\r\n  this.onWindowChange = undefined;\r\n\r\n  this.initCropWindowHandle(this._$cropWindowHandleTopRight, 'ne');\r\n  this.initCropWindowHandle(this._$cropWindowHandleBottomRight, 'se');\r\n  this.initCropWindowHandle(this._$cropWindowHandleBottomLeft, 'sw');\r\n  this.initCropWindowHandle(this._$cropWindowHandleTopLeft, 'nw');\r\n\r\n  this.initCropWindowDrag();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.activate = function() {\r\n  this._$cropWindowContainer.show();\r\n  this._$editor.show();\r\n  this.redrawWindow();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.deactivate = function() {\r\n  this._$cropWindowContainer.hide();\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @static\r\n * @private\r\n * @type {number}\r\n */\r\nCropEditor._dragNamespaceIndex = 0;\r\n\r\n/**\r\n * @private\r\n * @param {RelativeCropWindow} window\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.drawWindow = function(window) {\r\n  \r\n  this._$cropWindowContainer\r\n    .css('height', this._image.getHeight() + 'px')\r\n    .css('width', this._image.getWidth() + 'px')\r\n    .css('top', this._image.getOffsetTop() + 'px')\r\n    .css('left', this._image.getOffsetLeft() + 'px');\r\n\r\n  const windowLeft = Math.round(window.x0 * this._image.getWidth());\r\n  const windowRight = Math.round(window.x1 * this._image.getWidth());\r\n  const windowWidth = Math.max(0, windowRight - windowLeft);\r\n\r\n  const windowTop = Math.round(window.y0 * this._image.getHeight());\r\n  const windowBottom = Math.round(window.y1 * this._image.getHeight());\r\n  const windowHeight = Math.max(0, windowBottom - windowTop);\r\n\r\n  this._$cropWindow\r\n    .css('height', windowHeight + 'px')\r\n    .css('width', windowWidth + 'px')\r\n    .css('top', windowTop + 'px')\r\n    .css('left', windowLeft + 'px');\r\n\r\n  const bottomShadowHeight = this._image.getHeight() - windowHeight - windowTop;\r\n  const rightShadowWidth = this._image.getWidth() - windowWidth - windowLeft;\r\n\r\n  this._$cropShadowTop\r\n    .css('width', '100%')\r\n    .css('height', windowTop + 'px');\r\n\r\n  this._$cropShadowBottom\r\n    .css('width', '100%')\r\n    .css('height', bottomShadowHeight + 'px')\r\n    .css('top', windowBottom + 'px');\r\n\r\n  this._$cropShadowLeft\r\n    .css('width', windowLeft + 'px')\r\n    .css('height', windowHeight + 'px')\r\n    .css('top', windowTop + 'px');\r\n\r\n  this._$cropShadowRight\r\n    .css('width', rightShadowWidth + 'px')\r\n    .css('height', windowHeight + 'px')\r\n    .css('left', windowRight + 'px')\r\n    .css('top', windowTop + 'px');\r\n\r\n  const absWindow = this.getAbsoluteCropWindow(window, this._image.getNaturalWidth(), this._image.getNaturalHeight());\r\n  this._$cropHeightNum[0].value = absWindow.height;\r\n  this._$cropWidthNum[0].value = absWindow.width;\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {RelativeCropWindow} relativeWindow\r\n * @param {number} imageWidth\r\n * @param {number} imageHeight\r\n * @returns {{ x: number, y: number, width: number, height: number }}\r\n */\r\nCropEditor.prototype.getAbsoluteCropWindow = function(relativeWindow, imageWidth, imageHeight) {\r\n  const x = Math.round(relativeWindow.x0 * imageWidth);\r\n  const width = Math.round(relativeWindow.x1 * imageWidth) - x;\r\n  const y = Math.round(relativeWindow.y0 * imageHeight);\r\n  const height = Math.round(relativeWindow.y1 * imageHeight) - y;\r\n  return {\r\n    height: height,\r\n    width: width,\r\n    x: x,\r\n    y: y\r\n  };\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.initCropWindowDrag = function() {\r\n\r\n  const self = this;\r\n\r\n  this._$cropWindow.off('mousedown.media_editor').on('mousedown.media_editor', function(downEvent) {\r\n    if (downEvent.target !== self._$cropWindow[0]) {\r\n      return;\r\n    }\r\n\r\n    let lastX = downEvent.clientX;\r\n    let lastY = downEvent.clientY;\r\n\r\n    self.startDrag(self._$cropWindow, \r\n      function(event) {\r\n        const imageHeight = self._image.getHeight();\r\n        const imageWidth = self._image.getWidth();\r\n        const absoluteWindow = self.getAbsoluteCropWindow(self._window, imageWidth, imageHeight);\r\n\r\n        let absX0 = absoluteWindow.x;\r\n        let absX1 = absoluteWindow.x + absoluteWindow.width;\r\n        let absY0 = absoluteWindow.y;\r\n        let absY1 = absoluteWindow.y + absoluteWindow.height;\r\n\r\n        let dx = event.clientX - lastX;\r\n        let dy = event.clientY - lastY;\r\n        \r\n        const isMovingRight = dx > 0;\r\n        if (isMovingRight) {\r\n          dx = Math.min(imageWidth - absX1, dx);\r\n        } else {\r\n          dx = Math.max(-absX0, dx);\r\n        }\r\n\r\n        const isMovingDown = dy > 0;\r\n        if(isMovingDown) {\r\n          dy = Math.min(imageHeight - absY1, dy);\r\n        } else {\r\n          dy = Math.max(-absY0, dy);\r\n        }\r\n\r\n        absX0 += dx;\r\n        absX1 += dx;\r\n        absY0 += dy;\r\n        absY1 += dy;\r\n\r\n        lastX += dx;\r\n        lastY += dy\r\n\r\n        self._window = {\r\n          x0: absX0 / imageWidth,\r\n          x1: absX1 / imageWidth,\r\n          y0: absY0 / imageHeight,\r\n          y1: absY1 / imageHeight\r\n        };\r\n        self.drawWindow(self._window);\r\n      },\r\n      function() {\r\n        if (self.onWindowChange) self.onWindowChange(_.extend(self._window));\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {JQuery} $handleElement\r\n * @param {('nw' | 'ne' | 'se' | 'sw')}\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.initCropWindowHandle = function($handleElement, corner) {\r\n  const self = this;\r\n  $handleElement.off('mousedown.media_editor').on('mousedown.media_editor', function() {\r\n    self.startDrag($handleElement, function(event) {\r\n\r\n      const imageXY = self._image.mapClientXYToImageProportionalXY(event.clientX, event.clientY);\r\n      const imageX = Math.max(0, Math.min(1, imageXY.x));\r\n      const imageY = Math.max(0, Math.min(1, imageXY.y));\r\n\r\n      const moveTopEdge = function() {\r\n        self._window.y0 = Math.min(self._window.y1, imageY);\r\n      };\r\n\r\n      const moveBottomEdge = function() {\r\n        self._window.y1 = Math.max(self._window.y0, imageY);\r\n      };\r\n\r\n      const moveRightEdge = function() {\r\n        self._window.x1 = Math.max(self._window.x0, imageX);\r\n      }\r\n\r\n      const moveLeftEdge = function() {\r\n        self._window.x0 = Math.min(self._window.x1, imageX);\r\n      }\r\n\r\n      switch (corner) {\r\n        case 'ne':\r\n          moveTopEdge()\r\n          moveRightEdge();\r\n          break;\r\n        case 'se':\r\n          moveBottomEdge();\r\n          moveRightEdge();\r\n          break;\r\n        case 'sw':\r\n          moveBottomEdge();\r\n          moveLeftEdge();\r\n          break;\r\n        case 'nw':\r\n          moveTopEdge();\r\n          moveLeftEdge();\r\n          break;\r\n      }\r\n\r\n      self.drawWindow(self._window);\r\n    },\r\n    function() {\r\n      if (self.onWindowChange) self.onWindowChange(_.extend(self._window));\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.redrawWindow = function() {\r\n  this.drawWindow(this._window);\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {RelativeCropWindow} relativeCropWindow\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.setWindow = function(relativeCropWindow) {\r\n  this._window = {\r\n    x0: relativeCropWindow.x0,\r\n    x1: relativeCropWindow.x1,\r\n    y0: relativeCropWindow.y0,\r\n    y1: relativeCropWindow.y1\r\n  }\r\n\r\n  this.drawWindow(this._window);\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {boolean} show\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.showWindow = function(show) {\r\n  show ? this._$cropWindowContainer.show() : this._$cropWindowContainer.hide();\r\n  this.drawWindow(this._window);\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {JQuery} $element\r\n * @param {(event: MouseEvent) => void} dragStartCb\r\n * @param {() => void} [dragEndCallback]\r\n * @returns {void}\r\n */\r\nCropEditor.prototype.startDrag = function($element, dragStartCb, dragEndCallback) {\r\n\r\n  const namespace = '_' + CropEditor._dragNamespaceIndex++;\r\n  const mouseUpEventName = 'mouseup.' + namespace;\r\n  const mouseMoveEventName = 'mousemove.' + namespace;\r\n\r\n  const cleanup = function() {\r\n    $(window).off(mouseUpEventName);\r\n    $(window).off(mouseMoveEventName);\r\n  }\r\n\r\n  $(window).on(mouseUpEventName, function() {\r\n    cleanup();\r\n    if (dragEndCallback) dragEndCallback();\r\n  });\r\n\r\n  $(window).on(mouseMoveEventName, _.throttle(function(event) {\r\n    window.getSelection().removeAllRanges();\r\n    dragStartCb(event);\r\n  }, 15));\r\n}\n\n//# sourceURL=webpack:///./src/cropEditor.js?");

/***/ }),

/***/ "./src/gammaEditor.js":
/*!****************************!*\
  !*** ./src/gammaEditor.js ***!
  \****************************/
/*! namespace exports */
/*! export GammaEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"GammaEditor\": () => /* binding */ GammaEditor\n/* harmony export */ });\n/**\r\n * @class\r\n * @param {JQuery} $imageEditor\r\n */\r\nfunction GammaEditor($imageEditor) {\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$editor = $imageEditor.find('[data-editor=\"gamma\"]');\r\n\r\n  /** @private @type {number} */\r\n  this._gamma = 0;\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$gammaSlider = this._$editor.find('[data-control-id=\"gammaRange\"]');\r\n\r\n  /**\r\n   * @public\r\n   * @type {(gamma: number) => void}\r\n   */\r\n  this.onGammaChange = undefined;\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nGammaEditor.prototype.activate = function() {\r\n  this._$editor.show();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nGammaEditor.prototype.deactivate = function() {\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {string}\r\n */\r\nGammaEditor.prototype.getTitle = function() {\r\n  return this._$editor.attr('data-editor-title')\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nGammaEditor.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n\r\n  this._$gammaSlider.off('change.media_editor').on('change.media_editor', function() {\r\n    self._gamma = parseFloat(self._$gammaSlider[0].value);\r\n    if (self.onGammaChange) self.onGammaChange(self._gamma);\r\n  });\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {number} gamma\r\n * @returns {void}\r\n */\r\nGammaEditor.prototype.setGamma = function(gamma) {\r\n  this._gamma = gamma;\r\n  this._$gammaSlider[0].value = gamma;\r\n}\n\n//# sourceURL=webpack:///./src/gammaEditor.js?");

/***/ }),

/***/ "./src/image.js":
/*!**********************!*\
  !*** ./src/image.js ***!
  \**********************/
/*! namespace exports */
/*! export Image [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__, __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Image\": () => /* binding */ Image\n/* harmony export */ });\n/* harmony import */ var _cropEditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cropEditor */ \"./src/cropEditor.js\");\n\r\n\r\n\r\n/**\r\n * @class\r\n * @param {JQuery} $imageWrapper\r\n */\r\nfunction Image($imageWrapper, imageUrl) {\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$imageWrapper = $imageWrapper;\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$image = this._$imageWrapper.find('img');\r\n\r\n  /** @private @type {string} */\r\n  this._imageUrl = imageUrl;\r\n\r\n  /** @private @type {number} */\r\n  this._naturalWidth = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._naturalHeight = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._originalWidth = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._originalHeight = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._offsetLeft = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._offsetTop = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._width = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._height = 0;\r\n\r\n  /** @private @type {number} */\r\n  this._zoomFactor = 1;\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nImage.prototype.applyZoomAndPosition = function() {\r\n\r\n  this._height = Math.round(this._naturalHeight * this._zoomFactor);\r\n  this._width = Math.round(this._naturalWidth * this._zoomFactor);\r\n\r\n  this._offsetLeft = (this._width < this._$imageWrapper.width()) ?\r\n    Math.round((this._$imageWrapper.width() - this._width) / 2) : 0;\r\n\r\n  this._offsetTop = (this._height < this._$imageWrapper.height()) ?\r\n    Math.round((this._$imageWrapper.height() - this._height) / 2) : 0;\r\n\r\n  this._$image\r\n    .css('height', this._height + 'px')\r\n    .css('width', this._width + 'px')\r\n    .css('left', this._offsetLeft + 'px')\r\n    .css('top', this._offsetTop + 'px');\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getHeight = function() {\r\n  return this._height;\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getNaturalHeight = function() {\r\n  return this._naturalHeight;\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getNaturalWidth = function() {\r\n  return this._naturalWidth;\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getOffsetLeft = function() {\r\n  return this._offsetLeft;\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getOffsetTop = function() {\r\n  return this._offsetTop;\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getOriginalHeight = function() {\r\n  return this._originalHeight;\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getOriginalWidth = function() {\r\n  return this._originalWidth;\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {number}\r\n */\r\nImage.prototype.getWidth = function() {\r\n  return this._width;\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {() => void} callback\r\n * @returns {void}\r\n */\r\nImage.prototype.initialize = function(callback) {  \r\n  const self = this;\r\n  this._$image.css('opacity', '0');\r\n  this.loadImage(this._imageUrl, function() {\r\n    self._originalHeight = self._$image[0].naturalHeight;\r\n    self._originalWidth = self._$image[0].naturalWidth;\r\n    self.loadImage('');\r\n    self._$image.css('opacity', '1');\r\n    if (callback) callback();\r\n  });\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {string} src\r\n * @param {() => void} callback\r\n * @returns {void}\r\n */\r\nImage.prototype.loadImage = function(src, callback) {\r\n  const self = this;\r\n  const loadEventName = 'load.media_editor';\r\n  this._$image.css('opacity', '0');\r\n  this._$image.attr('src', '');\r\n  this._$image.off(loadEventName).on(loadEventName, function() {\r\n    self._$image.off(loadEventName);\r\n    self._naturalHeight = self._$image[0].naturalHeight;\r\n    self._naturalWidth = self._$image[0].naturalWidth;\r\n    self.applyZoomAndPosition();    \r\n    if (callback) callback();\r\n  });\r\n  this._$image.attr('src', src);\r\n  this._$image.css('opacity', '1');\r\n}\r\n\r\n/**\r\n * The return value will have x,y as numbers relative\r\n * to the image width/height. Number less than or 0\r\n * or greater than 1 mean the point is out of bounds.\r\n * @public\r\n * @param {number} x - the client x-coordinate\r\n * @param {number} x - the client x-coordinate\r\n * @returns {{x: number, y: number}}\r\n */\r\nImage.prototype.mapClientXYToImageProportionalXY = function(x, y) {\r\n\r\n  /** @type {DOMRect} */\r\n  const imageClientRect = this._$image[0].getBoundingClientRect();\r\n\r\n  const relativeX = x - imageClientRect.left;\r\n  const relativeY = y - imageClientRect.top;\r\n  return {\r\n    x: relativeX / this.getWidth(),\r\n    y: relativeY / this.getHeight()\r\n  }\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {number} zoomFactor\r\n * @returns {void}\r\n */\r\nImage.prototype.setZoomFactor = function(zoomFactor) {\r\n  this._zoomFactor = zoomFactor;\r\n  this.applyZoomAndPosition();\r\n}\n\n//# sourceURL=webpack:///./src/image.js?");

/***/ }),

/***/ "./src/imageEditorController.js":
/*!**************************************!*\
  !*** ./src/imageEditorController.js ***!
  \**************************************/
/*! namespace exports */
/*! export ImageEditorController [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__, __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"ImageEditorController\": () => /* binding */ ImageEditorController\n/* harmony export */ });\n/* harmony import */ var _image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./image */ \"./src/image.js\");\n/* harmony import */ var _bottomToolbar__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./bottomToolbar */ \"./src/bottomToolbar.js\");\n/* harmony import */ var _topToolbar__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./topToolbar */ \"./src/topToolbar.js\");\n/* harmony import */ var _rotateEditor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./rotateEditor */ \"./src/rotateEditor.js\");\n/* harmony import */ var _resizeEditor__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./resizeEditor */ \"./src/resizeEditor.js\");\n/* harmony import */ var _cropEditor__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./cropEditor */ \"./src/cropEditor.js\");\n/* harmony import */ var _contrastEditor__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./contrastEditor */ \"./src/contrastEditor.js\");\n/* harmony import */ var _colorEditor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./colorEditor */ \"./src/colorEditor.js\");\n/* harmony import */ var _brightnessEditor__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./brightnessEditor */ \"./src/brightnessEditor.js\");\n/* harmony import */ var _gammaEditor__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./gammaEditor */ \"./src/gammaEditor.js\");\n/* harmony import */ var _sharpnessEditor__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./sharpnessEditor */ \"./src/sharpnessEditor.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @typedef {object} EditorBase\r\n * @property {() => void} activate \r\n * @property {() => void} deactivate \r\n * @property {() => string} getTitle \r\n * @property {() => void} imageUpdated\r\n */\r\n\r\n/** \r\n * @typedef {object} EditorConfig \r\n * @property {() => void} beforeActivate\r\n * @property {EditorBase} editor\r\n * @property {() => void} onReset\r\n * @property {() => void} onZoomChanged\r\n */\r\n\r\n/**\r\n * @typedef {object} TransformModel\r\n * @property {BrightnessModel} brightness\r\n * @property {ColorModel} color\r\n * @property {ContrastModel} contrast\r\n * @property {CropModel} crop\r\n * @property {GammaModel} gamma\r\n * @property {InvertModel} invert\r\n * @property {ResizeModel} resize\r\n * @property {RotateModel} rotate\r\n * @property {SharpnessModel} sharpness\r\n * \r\n\r\n/**\r\n * @typedef {object} BrightnessModel\r\n * @property {number} brightness - range: -1..1\r\n */\r\n\r\n/**\r\n * @typedef {object} ColorModel\r\n * @property {number} blueLevel - range: -1..1\r\n * @property {number} greenLevel - range: -1..1\r\n * @property {number} redLevel - range: -1..1\r\n */\r\n\r\n/**\r\n * @typedef {object} ContrastModel\r\n * @property {number} contrast - range: -1..1\r\n */\r\n\r\n/**\r\n * @typedef {object} CropModel\r\n * @property {RelativeCropWindow} window\r\n */\r\n\r\n/**\r\n * @typedef {object} GammaModel\r\n * @property {number} gamma - range: -1..1\r\n */\r\n\r\n/**\r\n * @typedef {object} InvertModel\r\n * @property {boolean} invert\r\n */\r\n\r\n/**\r\n * @typedef {object} ResizeModel\r\n * @property {number} width\r\n * @property {number} height\r\n */\r\n\r\n/**\r\n * @typedef {object} RotateModel\r\n * @property {boolean} flipHorizontal\r\n * @property {boolean} flipVertical\r\n * @property {number} rotationAngle\r\n */\r\n\r\n/**\r\n * @typedef {object} SharpnessModel\r\n * @property {number} sharpness - range: -1..1\r\n */\r\n\r\n/**\r\n * @typedef {object} RawQueryObject \r\n * @property {string | undefined} brightness - -1...1\r\n * @property {string | undefined} contrast - -1...1\r\n * @property {string | undefined} crop - \"<x>,<y>,<width>,<height>\"\r\n * @property {string | undefined} flip_horizontal - 0 or 1\r\n * @property {string | undefined} flip_vertical - 0 or 1\r\n * @property {string | undefined} gamma - -1...1\r\n * @property {string | undefined} invert - 0 or 1 \r\n * @property {string | undefined} levels - \"<red>,<green>,<blue>\"\r\n * @property {string| undefined} rotate - 0, 90, 180, 270\r\n * @property {string| undefined} resize - \"<width>,<height>\"\r\n * @property {string | undefined} sharpen - -1...1\r\n */\r\n\r\n/**\r\n * @typedef {object} RelativeCropWindow \r\n * @property {number} x0 - 0 to 1\r\n * @property {number} x1 - 0 to 1\r\n * @property {number} y0 - 0 to 1\r\n * @property {number} y1 - 0 to 1\r\n */\r\n\r\n/**\r\n * @typedef {object} InputImageInfo \r\n * @property {string} inputUrl\r\n * @property {UrlParts} zeroTransformUrlParts\r\n */\r\n\r\n/**\r\n * @typedef {object} UrlParts\r\n * @property {string} fragment\r\n * @property {string} query\r\n * @property {string} url - scheme, host, port, path\r\n */\r\n\r\nfunction ImageEditorController() {\r\n\r\n  /** @private @type {InputImageInfo} */\r\n  this._inputImageInfo = this.getInputImageInfo();\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$editor = $('.xformcontainer.xelemjsHarmonyCMS_Media_Editor');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$editorAreaWrapper = this._$editor.find('.editorAreaWrapper');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$editorTitle = this._$editor.find('[data-editor-title-placeholder]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$closeEditorButton = this._$editor.find('[data-action=\"closeEditor\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$imageWrapper = this._$editor.find('.imageWrapper');\r\n\r\n  /** @private @type {BottomToolbar} */\r\n  this._bottomToolbar = new _bottomToolbar__WEBPACK_IMPORTED_MODULE_1__.BottomToolbar(this._$editor);\r\n\r\n  /** @private @type {TopToolbar} */\r\n  this._topToolbar = new _topToolbar__WEBPACK_IMPORTED_MODULE_2__.TopToolbar(this._$editor);\r\n\r\n  /** @private @type {Image} */\r\n  this._image = new _image__WEBPACK_IMPORTED_MODULE_0__.Image(this._$imageWrapper, this.buildUrl(this._inputImageInfo.zeroTransformUrlParts));\r\n\r\n  /** @private @type {number} */\r\n  this._zoomIncrement = 0;\r\n\r\n  /** @private @type {TransformModel} */\r\n  this._model = this.getZeroTransformModel();\r\n\r\n  /** @private @type {EditorConfig | undefined} */\r\n  this._activeEditor = undefined;\r\n\r\n  /** @private  @type{{[editor: string]: EditorConfig}} */\r\n  this._editors = this.createEditors();\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {'horizontal' | 'vertical'} rawDirection\r\n * @returns {void}\r\n */\r\nImageEditorController.prototype.applyFlip = function(rawDirection) {\r\n\r\n  const flipHorizontal = rawDirection === 'horizontal';\r\n\r\n  if (flipHorizontal) {\r\n    this._model.rotate.flipHorizontal = !this._model.rotate.flipHorizontal;\r\n\r\n  } else {\r\n    this._model.rotate.flipVertical = !this._model.rotate.flipVertical;\r\n  }\r\n\r\n  this.loadImage(false);\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {'left' | 'right'} rawDirection\r\n * @returns {void}\r\n */\r\nImageEditorController.prototype.applyRotation = function(rawDirection) {\r\n  const hasSingleFlip = (this._model.rotate.flipHorizontal ^ this._model.rotate.flipVertical) === 1;\r\n  const rotateRight = (rawDirection === 'right' && !hasSingleFlip) || (rawDirection === 'left' && hasSingleFlip);\r\n  const currentAngle = this._model.rotate.rotationAngle || 0;\r\n  const wasSideways = currentAngle === 90 || currentAngle === 270;\r\n  if (rotateRight) {\r\n    this._model.rotate.rotationAngle = (currentAngle + 90) % 360;\r\n  } else {\r\n    this._model.rotate.rotationAngle = (currentAngle + 270) % 360;\r\n  }\r\n\r\n  const isSideways = this._model.rotate.rotationAngle === 90 || this._model.rotate.rotationAngle === 270;\r\n  if (wasSideways !== isSideways) {\r\n    const tempY = this._model.resize.height || 0;\r\n    this._model.resize.height = this._model.resize.width;\r\n    this._model.resize.width = tempY;\r\n  }\r\n\r\n  this.loadImage(false);\r\n}\r\n\r\n/**\r\n * Don't call this unless the image is loaded!\r\n * @private\r\n * @param {string} query - should not be decoded.\r\n * @returns {TransformModel}\r\n */\r\nImageEditorController.prototype.buildModelFromQuery = function(query) {\r\n\r\n  const self = this;\r\n\r\n  /** @type {Partial<RawQueryObject>} */\r\n  const queryObject = this.parseQueryString(query);\r\n\r\n  const model = this.getZeroTransformModel();\r\n\r\n  model.rotate.rotationAngle = this.parseInt(queryObject.rotate, 0);\r\n  model.rotate.flipHorizontal = queryObject.flip_horizontal === '1';\r\n  model.rotate.flipVertical = queryObject.flip_vertical === '1';\r\n  \r\n  if (model.rotate.flipVertical && model.rotate.flipHorizontal) {\r\n    model.rotate.flipHorizontal = false;\r\n    model.rotate.flipVertical = false;\r\n    model.rotate.rotationAngle = (model.rotate.rotationAngle + 180) % 360;\r\n  }\r\n  \r\n  const isSideways = model.rotate.rotationAngle === 90 || model.rotate.rotationAngle === 270;\r\n  const hasSingleFlip = (model.rotate.flipHorizontal ^ model.rotate.flipVertical) === 1;\r\n  if (isSideways && hasSingleFlip) {\r\n    const tempFlip = model.rotate.flipHorizontal;\r\n    model.rotate.flipHorizontal = model.rotate.flipVertical;\r\n    model.rotate.flipVertical = tempFlip;\r\n  }\r\n\r\n  if (queryObject.resize) {\r\n    const parts = queryObject.resize.split(',');\r\n    model.resize.width = this.parseInt(parts[isSideways ? 1 : 0], 0);\r\n    model.resize.height = this.parseInt(parts[isSideways ? 0 : 1], 0);\r\n  }\r\n\r\n  if (queryObject.crop) {\r\n    const values = _.map(queryObject.crop.split(','), function(value) { return self.parseInt(value, 0); });\r\n    // values: [x, y, width, height]\r\n    model.crop.window.x0 = values[0] / this._image.getOriginalWidth(); \r\n    model.crop.window.x1 = (values[0] + values[2]) / this._image.getOriginalWidth();\r\n    model.crop.window.y0 = values[1] / this._image.getOriginalHeight();\r\n    model.crop.window.y1 = (values[1] + values[3]) / this._image.getOriginalHeight();\r\n  }\r\n\r\n  if (queryObject.brightness) {\r\n    model.brightness.brightness = this.parseFloat(queryObject.brightness, 0);\r\n  }\r\n\r\n  if (queryObject.contrast) {\r\n    model.contrast.contrast = this.parseFloat(queryObject.contrast, 0);\r\n  }\r\n\r\n  if (queryObject.gamma) {\r\n    model.gamma.gamma = this.parseFloat(queryObject.gamma, 0);\r\n  }\r\n\r\n  model.invert.invert = queryObject.invert === '1'\r\n  \r\n  if (queryObject.levels) {\r\n    const levels = queryObject.levels.split(',');\r\n    model.color.redLevel = this.parseFloat(levels[0], 0);\r\n    model.color.greenLevel = this.parseFloat(levels[1], 0);\r\n    model.color.blueLevel = this.parseFloat(levels[2], 0);\r\n  }\r\n  \r\n  if (queryObject.sharpen) {\r\n    model.sharpness.sharpness = this.parseFloat(queryObject.sharpen, 0);\r\n  }\r\n\r\n  return model;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {UrlParts} urlParts\r\n * @param {string | undefined} additionalQuery\r\n * @returns {string}\r\n */\r\nImageEditorController.prototype.buildUrl = function(urlParts, additionalQuery) {\r\n  const queryParts = [];\r\n  if (urlParts.query) queryParts.push(urlParts.query);\r\n  if (additionalQuery) queryParts.push(additionalQuery);\r\n  const query = queryParts.join('&');\r\n  return urlParts.url + (query ? ('?' + query) : '') + (urlParts.fragment ? ('#' + urlParts.fragment) : '');\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {TransformModel} model\r\n * @returns {RawQueryObject}\r\n */\r\nImageEditorController.prototype.buildQueryObjectFromModel = function(model) {\r\n  if (!model) return '';\r\n  \r\n  /** @type {Partial<RawQueryObject>} */\r\n  const query = {};\r\n\r\n  let rotationAngle = model.rotate ? model.rotate.rotationAngle || 0 : 0;\r\n  const isSideways = rotationAngle === 90 || rotationAngle === 270;\r\n  let flipHorizontal = model.rotate ? model.rotate.flipHorizontal : false;\r\n  let flipVertical = model.rotate ? model.rotate.flipVertical : false;\r\n\r\n  if (flipVertical && flipHorizontal) {\r\n    flipHorizontal = false;\r\n    flipVertical = false;\r\n    rotationAngle = (rotationAngle + 180) % 360;\r\n  }\r\n\r\n  const hasSingleFlip = (flipHorizontal ^ flipVertical) === 1;\r\n  if (isSideways && hasSingleFlip) {\r\n    const tempFlip = flipHorizontal;\r\n    flipHorizontal = flipVertical;\r\n    flipVertical = tempFlip;\r\n  }\r\n\r\n  if (flipHorizontal) query.flip_horizontal = '1';\r\n  if (flipVertical) query.flip_vertical = '1';\r\n  if (rotationAngle) query.rotate = rotationAngle;\r\n\r\n\r\n  const isCropFullImage =\r\n    model.crop.window.x0 === 0 &&\r\n    model.crop.window.x1 === 1 &&\r\n    model.crop.window.y0 === 0 &&\r\n    model.crop.window.y1 === 1;\r\n  if (!isCropFullImage) {\r\n    const absCropWindow = this._editors.crop.editor.getAbsoluteCropWindow(model.crop.window, this._image.getOriginalWidth(), this._image.getOriginalHeight());\r\n    const hasCrop =\r\n      absCropWindow.height > 0 &&\r\n      absCropWindow.width > 0;\r\n  \r\n    if (hasCrop) {\r\n      const values = [\r\n        absCropWindow.x || 0,\r\n        absCropWindow.y || 0,\r\n        absCropWindow.width || 0,\r\n        absCropWindow.height || 0,\r\n      ];\r\n      query.crop = values.join(',');\r\n    }\r\n  }\r\n\r\n  if (model.resize != undefined) {\r\n    const hasResize =\r\n      model.resize.width > 0 ||\r\n      model.resize.height > 0;\r\n\r\n    if (hasResize) {\r\n      const width = model.resize.width || 0;\r\n      const height = model.resize.height || 0;\r\n      const values = [\r\n        isSideways ? height : width,\r\n        isSideways ? width : height\r\n      ];\r\n      query.resize = values.join(',');\r\n    }\r\n  }\r\n\r\n  const hasBrightnessChange = model.brightness.brightness !== 0;\r\n  if (hasBrightnessChange) query.brightness = model.brightness.brightness;\r\n\r\n  const hasContrastChange = model.contrast.contrast !== 0;\r\n  if (hasContrastChange) query.contrast = model.contrast.contrast;\r\n  \r\n  const hasColorLevelChange = \r\n    model.color.blueLevel !== 0 ||\r\n    model.color.greenLevel !== 0 ||\r\n    model.color.redLevel !== 0;\r\n\r\n  if (hasColorLevelChange) {\r\n    const values = [\r\n      model.color.redLevel,\r\n      model.color.greenLevel,\r\n      model.color.blueLevel\r\n    ];\r\n    query.levels = values.join(',');\r\n  }\r\n\r\n  const hasGammaChange = model.gamma.gamma !== 0;\r\n  if (hasGammaChange) query.gamma = model.gamma.gamma;\r\n\r\n  const invertImage = model.invert.invert;\r\n  if (invertImage) query.invert = '1';\r\n\r\n  const hasSharpnessChange = model.sharpness.sharpness !== 0;\r\n  if (hasSharpnessChange) query.sharpen = model.sharpness.sharpness;\r\n\r\n  return query;\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {{[editor: string]: EditorConfig}}\r\n */\r\nImageEditorController.prototype.createEditors = function() {\r\n\r\n  const self = this;\r\n\r\n  /**  @type{{[editor: string]: EditorConfig}} */\r\n  const editors = {\r\n    // Ensure the key matches the 'data-editor' attribute\r\n    // defined in the EJS for each editor type.\r\n\r\n    brightness: {\r\n      editor: new _brightnessEditor__WEBPACK_IMPORTED_MODULE_8__.BrightnessEditor(this._$editor),\r\n      beforeActivate: function() {\r\n        self._editors.brightness.editor.setBrightness(self._model.brightness.brightness);\r\n      },\r\n      onReset: function() {\r\n        self._editors.brightness.editor.setBrightness(self._model.brightness.brightness);\r\n      },\r\n      onZoomChanged: function() {}\r\n    },\r\n    color: {\r\n      editor: new _colorEditor__WEBPACK_IMPORTED_MODULE_7__.ColorEditor(this._$editor),\r\n      beforeActivate: function() {\r\n        self._editors.color.editor.setLevels(self._model.color.redLevel, self._model.color.greenLevel, self._model.color.blueLevel);\r\n      },\r\n      onReset: function() {\r\n        self._editors.color.editor.setLevels(self._model.color.redLevel, self._model.color.greenLevel, self._model.color.blueLevel);        \r\n      },\r\n      onZoomChanged: function() {}\r\n    },\r\n    contrast: {\r\n      editor: new _contrastEditor__WEBPACK_IMPORTED_MODULE_6__.ContrastEditor(this._$editor),\r\n      beforeActivate: function() {\r\n        self._editors.contrast.editor.setContrast(self._model.contrast.contrast);\r\n      },\r\n      onReset: function() {\r\n        self._editors.contrast.editor.setContrast(self._model.contrast.contrast);\r\n      },\r\n      onZoomChanged: function() {}\r\n    },\r\n    crop: { \r\n      editor: new _cropEditor__WEBPACK_IMPORTED_MODULE_5__.CropEditor(this._$editor, this._$imageWrapper, this._image),\r\n      beforeActivate: function() { \r\n        self._editors.crop.editor.setWindow(self.transformRelativeWindowToView(self._model.crop.window, self._model.rotate));\r\n      },\r\n      onReset: function() {\r\n        self._editors.crop.editor.setWindow(self.transformRelativeWindowToView(self._model.crop.window, self._model.rotate));\r\n      },\r\n      onZoomChanged: function() {\r\n        self._editors.crop.editor.redrawWindow();\r\n      }\r\n    },\r\n    gamma: {\r\n      editor: new _gammaEditor__WEBPACK_IMPORTED_MODULE_9__.GammaEditor(this._$editor),\r\n      beforeActivate: function() {\r\n        self._editors.gamma.editor.setGamma(self._model.gamma.gamma);\r\n      },\r\n      onReset: function() {\r\n        self._editors.gamma.editor.setGamma(self._model.gamma.gamma);\r\n      },\r\n      onZoomChanged: function() {}\r\n    },\r\n    resize: { \r\n      editor: new _resizeEditor__WEBPACK_IMPORTED_MODULE_4__.ResizeEditor(this._$editor, this._image),\r\n      beforeActivate: function() {},\r\n      onReset: function() {},\r\n      onZoomChanged: function() {}\r\n    },\r\n    rotate: { \r\n      editor: new _rotateEditor__WEBPACK_IMPORTED_MODULE_3__.RotateEditor(this._$editor),\r\n      beforeActivate: function() {},\r\n      onReset: function() {},\r\n      onZoomChanged: function() {}\r\n    },\r\n    sharpness: {\r\n      editor: new _sharpnessEditor__WEBPACK_IMPORTED_MODULE_10__.SharpnessEditor(this._$editor),\r\n      beforeActivate: function() {\r\n        self._editors.sharpness.editor.setSharpness(self._model.sharpness.sharpness);\r\n      },\r\n      onReset: function() {\r\n        self._editors.sharpness.editor.setSharpness(self._model.sharpness.sharpness);\r\n      },\r\n      onZoomChanged: function() {}\r\n    }\r\n  };\r\n  return editors;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {RelativeCropWindow} window\r\n * @param {'horizontal' | 'vertical'} direction\r\n * @return {RelativeCropWindow}\r\n */\r\nImageEditorController.prototype.flipRelativeWindow = function(window, direction) {\r\n\r\n  /** @type {RelativeCropWindow} */\r\n  const flippedWindow = {};\r\n\r\n  if (direction === 'horizontal') {\r\n    flippedWindow.x0 = 1 - window.x1;\r\n    flippedWindow.x1 = 1 - window.x0;\r\n    flippedWindow.y0 = window.y0;\r\n    flippedWindow.y1 = window.y1;\r\n  } else if (direction === 'vertical') {\r\n    flippedWindow.x0 = window.x0;\r\n    flippedWindow.x1 = window.x1;\r\n    flippedWindow.y0 = 1 - window.y1;\r\n    flippedWindow.y1 = 1 - window.y0;\r\n  } else {\r\n    throw new Error('Unknown direction: ' + direction);\r\n  }\r\n\r\n  return flippedWindow;\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {InputImageInfo}\r\n */\r\nImageEditorController.prototype.getInputImageInfo = function() {\r\n\r\n  const inputQueryObject = this.parseQueryString(window.location.search || '');\r\n  \r\n  const imageSourceParts = this.getUrlParts(inputQueryObject.image_source || '');\r\n  const imageSourceQueryObject = this.parseQueryString(imageSourceParts.query);\r\n  \r\n  const transformParams = {\r\n    'brightness': true,\r\n    'contrast': true,\r\n    'crop': true,\r\n    'flip_horizontal': true,\r\n    'flip_vertical': true,\r\n    'gamma': true,\r\n    'invert': true,\r\n    'levels': true,\r\n    'rotate': true,\r\n    'resize': true,\r\n    'sharpen': true\r\n  };\r\n\r\n  const zeroTransformParams = [];\r\n  _.forEach(_.entries(imageSourceQueryObject), function(kvp) {\r\n    const name = kvp[0];\r\n    if (transformParams[name]) return;\r\n    zeroTransformParams.push(name + '=' + encodeURIComponent(kvp[1]));\r\n  });\r\n\r\n  /** @type {InputImageInfo} */\r\n  const info = {    \r\n    url: inputQueryObject.image_source || '',\r\n    zeroTransformUrlParts: {\r\n      fragment: imageSourceParts.fragment,\r\n      query: zeroTransformParams.join('&'),\r\n      url: imageSourceParts.url\r\n    }\r\n  }\r\n\r\n  return info;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {string} url\r\n * @returns {UrlParts}\r\n*/\r\nImageEditorController.prototype.getUrlParts = function(url) {\r\n  url = url || '';\r\n  const fragmentIndex = url.indexOf('#');\r\n  const queryIndex = url.indexOf('?');\r\n\r\n  const fragment = (fragmentIndex > -1) ? url.slice(fragmentIndex + 1) : '';\r\n  url = (fragmentIndex > -1) ? url.slice(0, fragmentIndex) : url;\r\n\r\n  const query = (queryIndex > -1) ? url.slice(queryIndex + 1) : '';\r\n  url = (queryIndex > -1) ? url.slice(0, queryIndex) : url;\r\n\r\n  /** @type {UrlParts} */\r\n  const parts = {\r\n    fragment: fragment,\r\n    query: query,\r\n    url: url\r\n  };\r\n  return parts;\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {TransformModel}\r\n */\r\nImageEditorController.prototype.getZeroTransformModel = function() {\r\n  \r\n  /** @type {TransformModel} */\r\n  const model = {\r\n    brightness: {\r\n      brightness: 0\r\n    },\r\n    color: {\r\n      blueLevel: 0,\r\n      greenLevel: 0,\r\n      redLevel: 0\r\n    },\r\n    contrast: {\r\n      contrast: 0\r\n    },\r\n    crop: {\r\n      window: {\r\n        x0: 0,\r\n        x1: 1,\r\n        y0: 0,\r\n        y1: 1\r\n      }\r\n    },\r\n    gamma: {\r\n      gamma: 0\r\n    },\r\n    invert: {\r\n      invert: false\r\n    },\r\n    resize: {\r\n      height: 0,\r\n      width: 0\r\n    },\r\n    rotate: {\r\n      flipHorizontal: false,\r\n      flipVertical: false,\r\n      rotationAngle: 0\r\n    },\r\n    sharpness: {\r\n      sharpness: 0\r\n    } \r\n  };\r\n\r\n  return model;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {boolean} zoomIn\r\n * @returns {void}\r\n */\r\nImageEditorController.prototype.incrementZoom = function(zoomIn) {\r\n  const MAX_ZOOM = 2;\r\n  const ZOOM_STEP = MAX_ZOOM / 10;\r\n\r\n  if (zoomIn) {\r\n    this._zoomIncrement = Math.min(MAX_ZOOM, this._zoomIncrement + ZOOM_STEP);\r\n  } else {\r\n    this._zoomIncrement = Math.max(0, this._zoomIncrement - ZOOM_STEP);\r\n  }\r\n\r\n  this._image.setZoomFactor(this._zoomIncrement + 1);\r\n  if (this._activeEditor && this._activeEditor.onZoomChanged) this._activeEditor.onZoomChanged();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nImageEditorController.prototype.initialize = function() {\r\n  const self = this;\r\n\r\n  this._$closeEditorButton.on('click.media_editor', function() { self.setEditorMode(undefined); });\r\n\r\n  this._bottomToolbar.onCancel = function() {\r\n    window.close();\r\n  }\r\n\r\n  this._bottomToolbar.onDone = function() {\r\n    self.sendToEditor();\r\n    window.close();\r\n  };\r\n\r\n  this._bottomToolbar.onSetZoom = function(zoomIn) { self.incrementZoom(zoomIn); }\r\n\r\n  this._topToolbar.onInvertImage = function() {\r\n    self._model.invert = {\r\n      invert: !self._model.invert.invert\r\n    };\r\n    self.loadImage(false);\r\n  }\r\n  this._topToolbar.onSetMode = function(mode) { self.setEditorMode(mode); }\r\n\r\n  this._bottomToolbar.onReset = function() {\r\n    self._model  = self.getZeroTransformModel();\r\n    self._cropResizeFactor = { xFactor: 1, yFactor: 1 };\r\n    if (self._activeEditor && self._activeEditor.onReset) self._activeEditor.onReset();\r\n    self.loadImage(false);\r\n  }\r\n\r\n  this._editors.brightness.editor.onBrightnessChange = function(brightness) {\r\n    self._model.brightness = {\r\n      brightness: brightness\r\n    };\r\n    self.loadImage(false);\r\n  }\r\n\r\n  this._editors.color.editor.onLevelsChanged = function(red, green, blue) {\r\n    self._model.color = {\r\n      blueLevel: blue,\r\n      greenLevel: green,\r\n      redLevel: red\r\n    };\r\n    self.loadImage(false);\r\n  }\r\n\r\n  this._editors.contrast.editor.onContrastChange = function(contrast) {\r\n    self._model.contrast = {\r\n      contrast: contrast\r\n    };\r\n    self.loadImage(false);\r\n  }\r\n\r\n  this._editors.crop.editor.setWindow(this._model.crop.window);\r\n  this._editors.crop.editor.onWindowChange = function(window) {\r\n\r\n    self._model.crop = {\r\n      window: self.transformRelativeWindowToModel(window, self._model.rotate)\r\n    };   \r\n\r\n    const rotationAngle = self._model.rotate.rotationAngle || 0;\r\n    const isSideways = rotationAngle === 90 || rotationAngle === 270;\r\n    \r\n\r\n    const xFactor = (isSideways ? self._image.getNaturalHeight() : self._image.getNaturalWidth()) / self._image.getOriginalWidth();\r\n    const yFactor = (isSideways ? self._image.getNaturalWidth() : self._image.getNaturalHeight())  / self._image.getOriginalHeight();  \r\n    const isScaled = xFactor !== 1 || yFactor !== 1;\r\n    if (isScaled) {\r\n      const absCropWindow = self._editors.crop.editor.getAbsoluteCropWindow(self._model.crop.window, self._image.getOriginalWidth(), this._image.getOriginalHeight());\r\n\r\n      const imageWidth = Math.round(absCropWindow.width * xFactor);\r\n      const imageHeight = Math.round(absCropWindow.height * yFactor);\r\n      \r\n      self._model.resize = {\r\n        height: isSideways ? imageWidth : imageHeight,\r\n        width: isSideways ? imageHeight :imageWidth\r\n      };\r\n    } else {\r\n      self._model.resize = {\r\n        height: 0,\r\n        width: 0\r\n      }\r\n    }\r\n  }\r\n\r\n  this._editors.gamma.editor.onGammaChange = function(gamma) {\r\n    self._model.gamma = {\r\n      gamma: gamma\r\n    };\r\n    self.loadImage(false);\r\n  }\r\n\r\n  this._editors.rotate.editor.onFlipHorizontal = function() { self.applyFlip('horizontal'); }\r\n  this._editors.rotate.editor.onFlipVertical = function() { self.applyFlip('vertical'); }\r\n  this._editors.rotate.editor.onRotateLeft = function() { self.applyRotation('left'); }\r\n  this._editors.rotate.editor.onRotateRight = function() { self.applyRotation('right'); }\r\n\r\n  this._editors.resize.editor.onDimensionsChange = function(x, y) {\r\n\r\n    self._model.resize.height = y || 0;\r\n    self._model.resize.width = x || 0;\r\n    self.loadImage(false);\r\n  }\r\n\r\n  this._editors.sharpness.editor.onSharpnessChange = function(sharpness) {\r\n    self._model.sharpness = {\r\n      sharpness: sharpness\r\n    }\r\n    self.loadImage(false);\r\n  }\r\n\r\n  this._image.initialize(function() {\r\n    self._model = self.buildModelFromQuery(self.getUrlParts(self._inputImageInfo.url).query);\r\n    self._image.loadImage(self._inputImageInfo.url);\r\n  });\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {boolean} forCrop - true if loading image for crop\r\n * @param {() => void} callback\r\n * @returns {void}\r\n */\r\nImageEditorController.prototype.loadImage = function(forCrop, callback) {\r\n\r\n  const self = this;\r\n\r\n  /** @type {TransformModel} */\r\n  const model = _.extend({}, this._model);\r\n\r\n  const queryObject = this.buildQueryObjectFromModel(model);\r\n\r\n  let cropResizeParam = '';\r\n  if (forCrop) {\r\n    const hasResize = model.resize.height > 0 || model.resize.width > 0;\r\n    if (hasResize) {\r\n      const absCropWindow = this._editors.crop.editor.getAbsoluteCropWindow(model.crop.window, this._image.getOriginalWidth(), this._image.getOriginalHeight());\r\n      \r\n      let resizeXFactor = 0;\r\n      let resizeYFactor = 0;\r\n      const rotationAngle = this._model.rotate.rotationAngle || 0;\r\n      const isSideways = rotationAngle === 90 || rotationAngle === 270;\r\n\r\n      if (model.resize.height > 0) {\r\n        resizeYFactor = isSideways ? \r\n          (model.resize.width / absCropWindow.height) : (model.resize.height / absCropWindow.height);\r\n      }\r\n      if (model.resize.width > 0) {\r\n        resizeXFactor = isSideways ? \r\n          (model.resize.height / absCropWindow.width) : (model.resize.width / absCropWindow.width);        \r\n      }\r\n      resizeXFactor = resizeXFactor > 0 ? resizeXFactor : resizeYFactor;\r\n      resizeYFactor = resizeYFactor > 0 ? resizeYFactor : resizeXFactor;\r\n      const imageWidth = Math.round(resizeXFactor * this._image.getOriginalWidth());\r\n      const imageHeight = Math.round(resizeYFactor * this._image.getOriginalHeight());\r\n      \r\n      const resizeValue = [\r\n        imageWidth,\r\n        imageHeight\r\n      ].join(',');\r\n      cropResizeParam = 'resize=' + encodeURIComponent(resizeValue);\r\n    }\r\n  }\r\n\r\n  const allParams = [];\r\n  const imageLoadParams = [];\r\n  _.forEach(_.entries(queryObject), function(kvp) {\r\n    const paramName = kvp[0];\r\n    let qParam = paramName + '=' + encodeURIComponent(kvp[1]);\r\n    allParams.push(qParam)\r\n\r\n    if (forCrop && paramName === 'crop') qParam = undefined;\r\n    if (forCrop && paramName === 'resize') qParam = cropResizeParam;\r\n    if (qParam) imageLoadParams.push(qParam);\r\n  });\r\n\r\n  const imageLoadQuery = imageLoadParams.join('&');\r\n  const allParamQuery = allParams.join('&');\r\n\r\n  const src = this.buildUrl(this._inputImageInfo.zeroTransformUrlParts, imageLoadQuery);\r\n  this._image.loadImage(src, function() {\r\n    self._model = self.buildModelFromQuery(allParamQuery);\r\n    if (self._activeEditor && self._activeEditor.editor.imageUpdated) self._activeEditor.editor.imageUpdated();\r\n    if (callback) callback();\r\n  });\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {string | undefined} value\r\n * @param {number | undefined} defaultValue - number to use if value is NAN\r\n * @returns {number | undefined}\r\n */\r\nImageEditorController.prototype.parseFloat = function(value, defaultValue) {\r\n  const parsed = parseFloat(value);\r\n  return isNaN(parsed) ? defaultValue : parsed;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {string | undefined} value\r\n * @param {number | undefined} defaultValue - number to use if value is NAN\r\n * @returns {number | undefined}\r\n */\r\nImageEditorController.prototype.parseInt = function(value, defaultValue) {\r\n  const parsed = parseInt(value);\r\n  return isNaN(parsed) ? defaultValue : parsed;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {string} queryString\r\n * @returns {{[key: string]: string}\r\n */\r\nImageEditorController.prototype.parseQueryString = function(queryString) {\r\n  return (queryString|| '').replace(/^\\?/, '').split('&').reduce(function(obj, kvp) {\r\n    const parts = (kvp || '').split('=');\r\n    obj[parts[0]] = decodeURIComponent(parts[1] || '');\r\n    return obj\r\n  }, {});\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {RelativeCropWindow} window\r\n * @param {number} angle - 0, ±90, ±180, ±270\r\n * @returns {RelativeCropWindow}\r\n */\r\nImageEditorController.prototype.rotateRelativeWindow = function(window, angle) {\r\n\r\n  /** @type {RelativeCropWindow} */\r\n  const rotatedWindow = {};\r\n  if (angle === 0) {\r\n    rotatedWindow.x0 = window.x0;\r\n    rotatedWindow.x1 = window.x1;\r\n    rotatedWindow.y0 = window.y0;\r\n    rotatedWindow.y1 = window.y1;\r\n  } else if (angle === 270 || angle === -90) {\r\n    rotatedWindow.x0 = window.y0;\r\n    rotatedWindow.x1 = window.y1;\r\n    rotatedWindow.y0 = 1 - window.x1;\r\n    rotatedWindow.y1 = 1 - window.x0;\r\n  } else if (angle === 180 || angle === -180) {\r\n    rotatedWindow.x0 = 1 - window.x1;\r\n    rotatedWindow.x1 = 1 - window.x0;\r\n    rotatedWindow.y0 = 1 - window.y1;\r\n    rotatedWindow.y1 = 1 - window.y0;\r\n  } else if (angle === 90 || angle === -270) {\r\n    rotatedWindow.x0 = 1 - window.y1;\r\n    rotatedWindow.x1 = 1 - window.y0;\r\n    rotatedWindow.y0 = window.x0;\r\n    rotatedWindow.y1 = window.x1;\r\n  } else {\r\n    throw new Error('Invalid angle ' + angle);\r\n  }\r\n  return rotatedWindow;\r\n}\r\n\r\nImageEditorController.prototype.sendToEditor = function() {  \r\n  if (!window.opener) {\r\n    XExt.Alert('Parent editor not found');\r\n  } else {\r\n\r\n    const transformQuery = _.map(_.entries(this.buildQueryObjectFromModel(this._model)), function(kvp) {\r\n      return kvp[0] + '=' + encodeURIComponent(kvp[1])\r\n    }).join('&');\r\n\r\n    const data = {\r\n      image_source: this.buildUrl(this._inputImageInfo.zeroTransformUrlParts, transformQuery)\r\n    }\r\n    window.opener.postMessage('cms_media_editor:'+JSON.stringify(data), '*');\r\n  }\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {string | undefined} mode - matches key in _editors\r\n * @param {() => void} imageLoadCallback\r\n * @returns {void}\r\n */ \r\nImageEditorController.prototype.setEditorMode = function(mode, imageLoadCallback) {\r\n  const self = this;\r\n  \r\n  this._topToolbar.setVisibility(false)\r\n  this._$editorAreaWrapper.hide();\r\n  this._$editorTitle.empty();\r\n\r\n  if (this._activeEditor && this._activeEditor.editor.deactivate) this._activeEditor.editor.deactivate();\r\n\r\n  this._activeEditor = this._editors[mode];\r\n  if (!this._activeEditor) {\r\n    this._topToolbar.setVisibility(true);\r\n    this.loadImage(false);\r\n    return;\r\n  }\r\n\r\n  const isForCrop = mode === 'crop';\r\n\r\n  this.loadImage(isForCrop, function() {\r\n    if (self._activeEditor) {\r\n      if (self._activeEditor.beforeActivate) self._activeEditor.beforeActivate();\r\n      if (self._activeEditor.editor.activate) self._activeEditor.editor.activate();\r\n      if (self._activeEditor.editor.getTitle) self._$editorTitle.text(self._activeEditor.editor.getTitle());\r\n    }\r\n    self._$editorAreaWrapper.show();\r\n    if (imageLoadCallback) imageLoadCallback();\r\n  });\r\n\r\n  this._mode = mode;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {RelativeCropWindow} window\r\n * @param {RotateModel} rotateModel\r\n * @returns {RelativeCropWindow} \r\n */\r\nImageEditorController.prototype.transformRelativeWindowToModel = function(window, rotateModel) {\r\n\r\n  const rotationAngle = rotateModel.rotationAngle || 0;\r\n  let transformedWindow = this.rotateRelativeWindow(window, (360 - rotationAngle) % 360);\r\n  if (rotateModel.flipHorizontal) {\r\n    transformedWindow = this.flipRelativeWindow(transformedWindow, 'horizontal');\r\n  }\r\n  if (rotateModel.flipVertical) {\r\n    transformedWindow = this.flipRelativeWindow(transformedWindow, 'vertical');\r\n  }\r\n\r\n  return transformedWindow;\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {RelativeCropWindow} window\r\n * @param {RotateModel} rotateModel\r\n * @returns {RelativeCropWindow} \r\n */\r\nImageEditorController.prototype.transformRelativeWindowToView = function(window, rotateModel) {\r\n\r\n  const rotationAngle = rotateModel.rotationAngle || 0;\r\n  let transformedWindow = this.rotateRelativeWindow(window, rotationAngle);\r\n  if (rotateModel.flipHorizontal) {\r\n    transformedWindow = this.flipRelativeWindow(transformedWindow, 'horizontal');\r\n  }\r\n  if (rotateModel.flipVertical) {\r\n    transformedWindow = this.flipRelativeWindow(transformedWindow, 'vertical');\r\n  }\r\n\r\n  return transformedWindow;\r\n}\n\n//# sourceURL=webpack:///./src/imageEditorController.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! namespace exports */
/*! exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__, __webpack_require__.r, __webpack_exports__, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _imageEditorController__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./imageEditorController */ \"./src/imageEditorController.js\");\n\r\n\r\njsh.App[modelid] = new (function() {\r\n  this.oninit = function(xmodel) {\r\n    new _imageEditorController__WEBPACK_IMPORTED_MODULE_0__.ImageEditorController().initialize();\r\n  }\r\n})();\n\n//# sourceURL=webpack:///./src/index.js?");

/***/ }),

/***/ "./src/resizeEditor.js":
/*!*****************************!*\
  !*** ./src/resizeEditor.js ***!
  \*****************************/
/*! namespace exports */
/*! export ResizeEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__, __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"ResizeEditor\": () => /* binding */ ResizeEditor\n/* harmony export */ });\n/* harmony import */ var _image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./image */ \"./src/image.js\");\n\r\n\r\n/**\r\n * @class\r\n * @param {JQuery} $imageEditor\r\n * @param {Image} imageCanvas\r\n */\r\nfunction ResizeEditor($imageEditor, imageCanvas) {\r\n  this._$editor = $imageEditor.find('[data-editor=\"resize\"]');\r\n\r\n  /** @private @type {Image} */\r\n  this._imageCanvas = imageCanvas;\r\n\r\n  /** @type {(ResizeModel | undefined)} */\r\n  this._model = undefined;\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$heightNum = this._$editor.find('[data-control-id=\"resizeHeight\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$widthNum = this._$editor.find('[data-control-id=\"resizeWidth\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$unlockRatioButton = this._$editor.find('[data-action=\"unlockResizeRatio\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$lockRatioButton = this._$editor.find('[data-action=\"lockResizeRatio\"]');\r\n\r\n  /** @private @type {boolean} */\r\n  this._lockRatio = true;\r\n\r\n\r\n  /**\r\n   * @public\r\n   * @type {(x: number, y: number) => void }\r\n   */\r\n  this.onDimensionsChange = undefined;\r\n\r\n  this.initEventHandlers();\r\n\r\n  this.setLockRatio(true);\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nResizeEditor.prototype.activate = function() {\r\n  this._$editor.show()\r\n  this._$heightNum[0].value = this._imageCanvas.getNaturalHeight();\r\n  this._$widthNum[0].value = this._imageCanvas.getNaturalWidth();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nResizeEditor.prototype.deactivate = function() {\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {string}\r\n */\r\nResizeEditor.prototype.getTitle = function() {\r\n  return this._$editor.attr('data-editor-title')\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nResizeEditor.prototype.imageUpdated = function() {\r\n  this._$heightNum[0].value = this._imageCanvas.getNaturalHeight();\r\n  this._$widthNum[0].value = this._imageCanvas.getNaturalWidth();\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nResizeEditor.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n\r\n  this._$heightNum.off('change.media_query').on('change.media_query', function() {\r\n    const height = Math.round(self._$heightNum[0].value);\r\n    let width = Math.random(self._$widthNum[0].value);\r\n\r\n    if (self._lockRatio) {\r\n      const factor = height / self._imageCanvas.getNaturalHeight();\r\n      width = Math.round(self._imageCanvas.getNaturalWidth() * factor);\r\n    }\r\n\r\n    if (self.onDimensionsChange) self.onDimensionsChange(width, height);\r\n  });\r\n\r\n  this._$widthNum.off('change.media_query').on('change.media_query', function() {\r\n    const width = Math.round(self._$widthNum[0].value);\r\n    let height = Math.round(self._$heightNum[0].value);\r\n\r\n    if (self._lockRatio) {\r\n      const factor = width / self._imageCanvas.getNaturalWidth();\r\n      height = Math.round(self._imageCanvas.getNaturalHeight() * factor);     \r\n    }\r\n\r\n    if (self.onDimensionsChange) self.onDimensionsChange(width, height);\r\n  });\r\n\r\n  this._$unlockRatioButton.off('click.media_query').on('click.media_query', function() { self.setLockRatio(false); });\r\n  this._$lockRatioButton.off('click.media_query').on('click.media_query', function() { self.setLockRatio(true); });\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {boolean} lock\r\n * @returns {void}\r\n */\r\nResizeEditor.prototype.setLockRatio = function(lock) {\r\n  this._lockRatio = lock;\r\n  if (lock) {\r\n    this._$lockRatioButton.hide();\r\n    this._$unlockRatioButton.show();\r\n  } else {\r\n    this._$lockRatioButton.show();\r\n    this._$unlockRatioButton.hide();\r\n  }\r\n}\n\n//# sourceURL=webpack:///./src/resizeEditor.js?");

/***/ }),

/***/ "./src/rotateEditor.js":
/*!*****************************!*\
  !*** ./src/rotateEditor.js ***!
  \*****************************/
/*! namespace exports */
/*! export RotateEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"RotateEditor\": () => /* binding */ RotateEditor\n/* harmony export */ });\n/** @typedef {import('./imageEditorController').RotateModel} RotateModel*/\r\n\r\n/**\r\n * @class\r\n * @param {JQuery} $imageEditor\r\n */\r\nfunction RotateEditor($imageEditor) {\r\n\r\n  this._$editor = $imageEditor.find('[data-editor=\"rotate\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$flipHorizontalButton = this._$editor.find('button[data-action=\"flipHorizontal\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$flipVerticalButton = this._$editor.find('button[data-action=\"flipVertical\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$rotateLeftButton = this._$editor.find('button[data-action=\"rotateLeft\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$rotateRightButton = this._$editor.find('button[data-action=\"rotateRight\"]');\r\n\r\n  /** @public @type {(() => void) | undefined} */\r\n  this.onRotateLeft = undefined;\r\n\r\n  /** @public @type {(() => void) | undefined} */\r\n  this.onRotateRight = undefined;\r\n\r\n  /** @public @type {(() => void) | undefined} */\r\n  this.onFlipHorizontal = undefined;\r\n\r\n  /** @public @type {(() => void) | undefined} */\r\n  this.onFlipVertical = undefined;\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nRotateEditor.prototype.activate = function() {\r\n  this._$editor.show();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nRotateEditor.prototype.deactivate = function() {\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {boolean} flipHorizontal\r\n * @returns {void}\r\n */\r\nRotateEditor.prototype.flip = function(flipHorizontal) {\r\n\r\n  if (flipHorizontal && this.onFlipHorizontal) this.onFlipHorizontal();\r\n  else if (this.onFlipVertical) this.onFlipVertical();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {string}\r\n */\r\nRotateEditor.prototype.getTitle = function() {\r\n  return this._$editor.attr('data-editor-title');\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nRotateEditor.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n  this._$flipHorizontalButton.off('click.media_editor').on('click.media_editor', function() { self.flip(true); });\r\n  this._$flipVerticalButton.off('click.media_editor').on('click.media_editor', function() { self.flip(false); });\r\n  this._$rotateLeftButton.off('click.media_editor').on('click.media_editor', function() { self.rotate(true); });\r\n  this._$rotateRightButton.off('click.media_editor').on('click.media_editor', function() { self.rotate(false); });\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {boolean} rotateLeft\r\n * @returns {void}\r\n */\r\nRotateEditor.prototype.rotate = function(rotateLeft) {\r\n\r\n  if (rotateLeft && _.isFunction(this.onRotateLeft)) this.onRotateLeft();\r\n  else if(_.isFunction(this.onRotateLeft)) this.onRotateRight();\r\n}\n\n//# sourceURL=webpack:///./src/rotateEditor.js?");

/***/ }),

/***/ "./src/sharpnessEditor.js":
/*!********************************!*\
  !*** ./src/sharpnessEditor.js ***!
  \********************************/
/*! namespace exports */
/*! export SharpnessEditor [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"SharpnessEditor\": () => /* binding */ SharpnessEditor\n/* harmony export */ });\n/**\r\n * @class\r\n * @param {JQuery} $imageEditor\r\n */\r\nfunction SharpnessEditor($imageEditor) {\r\n\r\n  /** @private @{JQuery} */\r\n  this._$editor = $imageEditor.find('[data-editor=\"sharpness\"]');\r\n\r\n  /** @private @{JQuery} */\r\n  this._$sharpnessSlider = this._$editor.find('[data-control-id=\"sharpnessRange\"]');\r\n\r\n  /** @private @type {number} */\r\n  this._sharpness = undefined;\r\n\r\n  /**\r\n   * @public\r\n   * @type {(sharpness: number) => void}\r\n   */\r\n  this.onSharpnessChange = undefined;\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nSharpnessEditor.prototype.activate = function() {\r\n  this._$editor.show();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {void}\r\n */\r\nSharpnessEditor.prototype.deactivate = function() {\r\n  this._$editor.hide();\r\n}\r\n\r\n/**\r\n * @public\r\n * @returns {string}\r\n */\r\nSharpnessEditor.prototype.getTitle = function() {\r\n  return this._$editor.attr('data-editor-title')\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nSharpnessEditor.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n  this._$sharpnessSlider.off('change.media_editor').on('change.media_editor', function() { \r\n    self._sharpness = parseFloat(self._$sharpnessSlider[0].value);\r\n    if (self.onSharpnessChange) self.onSharpnessChange(self._sharpness);\r\n  });\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {boolean} sharpness\r\n * @returns {void}\r\n */\r\nSharpnessEditor.prototype.setSharpness = function(sharpness) {\r\n  this._sharpness = sharpness;\r\n  this._$sharpnessSlider[0].value = sharpness;\r\n}\n\n//# sourceURL=webpack:///./src/sharpnessEditor.js?");

/***/ }),

/***/ "./src/topToolbar.js":
/*!***************************!*\
  !*** ./src/topToolbar.js ***!
  \***************************/
/*! namespace exports */
/*! export TopToolbar [provided] [no usage info] [missing usage info prevents renaming] */
/*! other exports [not provided] [no usage info] */
/*! runtime requirements: __webpack_require__.r, __webpack_exports__, __webpack_require__.d, __webpack_require__.* */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"TopToolbar\": () => /* binding */ TopToolbar\n/* harmony export */ });\n/**\r\n * @class\r\n */\r\nfunction TopToolbar($imageEditor) {\r\n\r\n  this._$toolbar = $imageEditor.find('.topToolbar');\r\n\r\n  /**\r\n   * @public\r\n   * @type {((mode: string) => void) | undefined}\r\n   */\r\n  this.onSetMode = undefined;\r\n\r\n  /**\r\n   * @public\r\n   * @type {(() => void) | undefined}\r\n   */\r\n  this.onInvertImage = undefined;\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$brightnessButton = this._$toolbar.find('[data-activate-editor=\"brightness\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$colorButton = this._$toolbar.find('[data-activate-editor=\"color\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$contrastButton = this._$toolbar.find('[data-activate-editor=\"contrast\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$cropButton = this._$toolbar.find('[data-activate-editor=\"crop\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$gammaButton = this._$toolbar.find('[data-activate-editor=\"gamma\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$invertButton = this._$toolbar.find('[data-activate-editor=\"invert\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$resizeButton = this._$toolbar.find('[data-activate-editor=\"resize\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$rotateButton = this._$toolbar.find('[data-activate-editor=\"rotate\"]');\r\n\r\n  /** @private @type {JQuery} */\r\n  this._$sharpnessButton = this._$toolbar.find('[data-activate-editor=\"sharpness\"]');\r\n\r\n  this.initEventHandlers();\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {void}\r\n */\r\nTopToolbar.prototype.initEventHandlers = function() {\r\n  const self = this;\r\n\r\n  // Initialize buttons that activate editors.\r\n  _.forEach([\r\n    this._$brightnessButton,\r\n    this._$colorButton,\r\n    this._$contrastButton,\r\n    this._$cropButton,\r\n    this._$gammaButton,\r\n    this._$resizeButton,\r\n    this._$rotateButton,\r\n    this._$sharpnessButton\r\n  ], function($button) {\r\n    $button.off('click.media_editor').on('click.media_editor', function() {\r\n      self.switchMode($(this).attr('data-activate-editor'));\r\n    });\r\n  });\r\n\r\n  this._$invertButton.off('click.media_editor').on('click.media_editor', function() {\r\n    if (_.isFunction(self.onInvertImage)) self.onInvertImage();\r\n  });\r\n}\r\n\r\n/**\r\n * @public\r\n * @param {boolean} visible\r\n * @returns {void}\r\n */\r\nTopToolbar.prototype.setVisibility = function(visible) {\r\n  visible ? this._$toolbar.show() : this._$toolbar.hide();\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {string} mode\r\n * @returns {void}\r\n */\r\nTopToolbar.prototype.switchMode = function(mode) {\r\n  if (_.isFunction(this.onSetMode)) this.onSetMode(mode);\r\n}\n\n//# sourceURL=webpack:///./src/topToolbar.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		if(__webpack_module_cache__[moduleId]) {
/******/ 			return __webpack_module_cache__[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	// startup
/******/ 	// Load entry module
/******/ 	__webpack_require__("./src/index.js");
/******/ 	// This entry module used 'exports' so it can't be inlined
/******/ })()
;